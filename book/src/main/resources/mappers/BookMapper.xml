<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.service.impl.BookMapper">

<!-- 전체조회 -->
<select id="selectBook" resultType="bookVO">
	SELECT  BOOK_NO,
			BOOK_NAME,
			BOOK_COVERIMG,
			TO_CHAR(BOOK_DATE, 'YYYY/MM/DD') AS BOOK_DATE,
			TO_CHAR(BOOK_PRICE, '999,999,999') AS BOOK_PRICE,
			BOOK_PUBLISHER,
			BOOK_INFO
	FROM BOOK_TBL_06		   
</select>

<!-- 등록 -->
<insert id="insertBook" parameterType="bookVO">
	INSERT INTO BOOK_TBL_06(
							BOOK_NO,
							BOOK_NAME,
							BOOK_COVERIMG,
							BOOK_DATE,
							BOOK_PRICE,
							BOOK_PUBLISHER,
							BOOK_INFO
	)
		   
	VALUES(seq_book06.nextval,
		   #{bookName},
		   #{bookCoverImg},
		   #{bookDate},
		   #{bookPrice},
		   #{bookPublisher},
		   #{bookInfo}
	)
</insert>

<!-- 대여현황 -->
<select id="selectRent" resultType="bookVO">
SELECT 
    B.BOOK_NO,
    B.BOOK_NAME,
    COUNT(R.RENT_NO) AS RENT_COUNT,
    NVL(SUM(R.RENT_PRICE), 0) AS TOTAL_RENT_PRICE
FROM 
    BOOK_TBL_06 B
JOIN 
    RENT_TBL_06 R
ON 
    B.BOOK_NO = R.BOOK_NO
GROUP BY 
    B.BOOK_NO, B.BOOK_NAME
ORDER BY 
    B.BOOK_NO    
</select>

</mapper>